# Angry Children 2
原题见[这里](https://www.hackerrank.com/challenges/angry-children-2/problem)

有n包糖果，每包里面的糖果数各不相同，要从中选择k包分给k个孩子，使得选择的这k包糖果，两两数量之差的绝对值之和最小，输出这个最小值。

例如，有7包糖果，数量如下[3, 3, 4, 5, 7, 9, 10]，k = 3，假设选择的是[4, 7, 9]，则两两数量之差的绝对值之和计算如下：
* |4 - 7| + |4 - 9| + |7 - 9| = 3 + 5 + 2 = 10

而如果要让值最小，应该选择[3, 3, 4]，这样结果为：
* |3 - 3| + |3 - 4| + |3 - 4| = 0 + 1 + 1 = 2

# 分析
对于这种有绝对值计算的，我就很想去掉绝对值，直接减，那么，理所当然，先排个序，然后按从大到小的方式选择元素，这样就始终用前面的数减后面的数就好了。

然后，选择的时候有没有什么策略或准则呢？有！那就是，选择的k个元素在排好序的数组中一定是相邻的。

用反证法，假设在绝对值之和最小的情况下选择的k个元素在数组中不是都相邻的，令t = k - 1，将此k项放入一个数组a，下标从0开始，且a[0] >= a[1] >= a[2] >= ... >= a[t-1] >= a[t]。

设存在一项p满足 a[i] >= p >= a[i+1], 0 <= i <= t - 1。

首先来看绝对值之和如何计算。对于a[0]， 只可能出现在被减数的位置，即出现在a[0] - a[1], a[0] - a[2], a[0] - a[3] ... a[0] - a[t-1], a[0] - a[t]。一共t次，对最后之和贡献的值为 t * a[0]。

对于a[1]， 出现在减数的位置1次，即a[0] - a[1]，被减数的位置(t-1)次即a[1] - a[2], a[1] - a[3] ... a[1] - a[t-1], a[1] - a[t]。对最后和的贡献值为(t-2) * a[1]。

依次类推， a[2]贡献值为(t-4) * a[2]， a[3]为(t-6)*a[3]，得到任一项i的贡献值公式为：
* (t - 2 * i) * a[i]

注意，每包糖果数肯定是大于等于0的， 因此上述公式的正负完全取决于i与t的大小关系。

回到上面， 存在a[i] >= p >= a[i+1], 对i与t大小关系的两种情况进行讨论。

第一种， t >= 2 * i, 则若将a[i]更换成p, 由于其他项不变， (t - 2 * i) * a[i] >= (t - 2 * i) * p，能够得到更小的绝对值之和。

第二种， t < 2 * i， 则若将a[i+1]更换成p， 其他项不变， 0 >= (t - 2 * (i + 1)) * a[i+1]  >= (t - 2 * (i + 1)) * p，同样能够得到更小的绝对值之和。

这样无论如何，都能构建出更小的绝对值之和，与数组a构成绝对值之和的最小值是矛盾的。

所以，无论如何就是选连续的k项，计算对应的值，最后输出其中最大的即可。

计算连续k项对应的值的方式，就是上面的贡献值公式累加，而且，从第二次计算开始，可以通过递推的方式得到。

假设从大到小排好序的数组为arr，value[i-1]表示以第i-1项作为结尾的对应的值，那么value[i]与value[i-1]相比，对应的选择项是去除了arr[i-k]，加入了arr[i]。

去除arr[i-k]意味着value[i]对于value[i-1], 去除了：
* (arr[i-k] - arr[i-k+1]) + (arr[i-k] - arr[i-k+2]) + ... + (arr[i-k] - arr[i - k + (k - 1)]) = (k-1) * arr[i-k] - (arr[i-k+1] + arr[i-k+2] + ... + arr[i - 1])

而加入arr[i]意味着value[i]对于value[i-1], 增加了：
* (arr[i-k+1] - arr[i]) + (arr[i-k+2] - arr[i]) + ... + (arr[i - 1] - arr[i]) = (arr[i-k+1] + arr[i-k+2] + ... + arr[i - 1]) - (k-1) * arr[i]

将两式合并，总的增加数就是：
* 2 * (arr[i-k+1] + arr[i-k+2] + ... + arr[i - 1]) - (k-1)(arr[i-k] + arr[i])

这样，只要提前计算好连续k-1项之和， 就可以很容易的递推计算出每一项为结尾元素的相应值了。

具体代码见[solve.php](./solve.php)